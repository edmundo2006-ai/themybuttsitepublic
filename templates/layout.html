<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
        <title>The MY Buttsite</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
        <script defer src="https://cdn.jsdelivr.net/npm/flowbite@2/dist/flowbite.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    </head>

    <body>
        <div class="flex justify-between items-start w-full px-4 py-2">
          <img src="{{ 'mybuttlogo.png' | public_image_url }}" alt="Logo" class="h-12 w-auto">
          <img src="{{ 'mybuttlogo.png' | public_image_url }}" alt="Logo" class="h-12 w-auto">
        </div>

<!-- Shared toast viewport + stack (used by flashes and JS) -->
<div id="toast-viewport"
     class="pointer-events-none fixed inset-x-0 top-4 z-50 flex justify-center px-4">
  <div id="toast-stack" class="flex w-full max-w-sm flex-col gap-3">
    {# Server flashes render directly into the stack #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          {% set cat = (category or 'info')|lower %}
          {% if cat in ['success','ok'] %}
            {% set box = 'bg-green-50 text-green-900 ring-1 ring-green-200 dark:bg-green-900/30 dark:text-green-100 dark:ring-green-700/50' %}
            {% set btn = 'text-green-700 hover:bg-green-100/70 dark:text-green-200 dark:hover:bg-green-800/50' %}
          {% elif cat in ['error','danger'] %}
            {% set box = 'bg-red-50 text-red-900 ring-1 ring-red-200 dark:bg-red-900/30 dark:text-red-100 dark:ring-red-700/50' %}
            {% set btn = 'text-red-700 hover:bg-red-100/70 dark:text-red-200 dark:hover:bg-red-800/50' %}
          {% elif cat in ['warning','warn'] %}
            {% set box = 'bg-amber-50 text-amber-900 ring-1 ring-amber-200 dark:bg-amber-900/30 dark:text-amber-100 dark:ring-amber-700/50' %}
            {% set btn = 'text-amber-700 hover:bg-amber-100/70 dark:text-amber-200 dark:hover:bg-amber-800/50' %}
          {% else %}
            {% set box = 'bg-blue-50 text-blue-900 ring-1 ring-blue-200 dark:bg-blue-900/30 dark:text-blue-100 dark:ring-blue-700/50' %}
            {% set btn = 'text-blue-700 hover:bg-blue-100/70 dark:text-blue-200 dark:hover:bg-blue-800/50' %}
          {% endif %}

          <div data-toast
               class="pointer-events-auto flex items-start gap-3 rounded-xl px-4 py-3 shadow-sm transition
                      opacity-0 translate-y-2 {{ box }}">
            <div class="min-w-0 text-sm font-medium">
              {{ message }}
            </div>
            <button type="button" data-toast-close
                    class="ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg transition {{ btn }}"
                    aria-label="Close">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                      d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                      clip-rule="evenodd" />
              </svg>
            </button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>
</div>

<script>
  // same showToast as you had, but it appends to #toast-stack
  const TOAST_STYLES = {
    success:{box:'bg-green-50 text-green-900 ring-1 ring-green-200 dark:bg-green-900/30 dark:text-green-100 dark:ring-green-700/50',btn:'text-green-700 hover:bg-green-100/70 dark:text-green-200 dark:hover:bg-green-800/50'},
    ok:{box:'bg-green-50 text-green-900 ring-1 ring-green-200 dark:bg-green-900/30 dark:text-green-100 dark:ring-green-700/50',btn:'text-green-700 hover:bg-green-100/70 dark:text-green-200 dark:hover:bg-green-800/50'},
    error:{box:'bg-red-50 text-red-900 ring-1 ring-red-200 dark:bg-red-900/30 dark:text-red-100 dark:ring-red-700/50',btn:'text-red-700 hover:bg-red-100/70 dark:text-red-200 dark:hover:bg-red-800/50'},
    danger:{box:'bg-red-50 text-red-900 ring-1 ring-red-200 dark:bg-red-900/30 dark:text-red-100 dark:ring-red-700/50',btn:'text-red-700 hover:bg-red-100/70 dark:text-red-200 dark:hover:bg-red-800/50'},
    warning:{box:'bg-amber-50 text-amber-900 ring-1 ring-amber-200 dark:bg-amber-900/30 dark:text-amber-100 dark:ring-amber-700/50',btn:'text-amber-700 hover:bg-amber-100/70 dark:text-amber-200 dark:hover:bg-amber-800/50'},
    warn:{box:'bg-amber-50 text-amber-900 ring-1 ring-amber-200 dark:bg-amber-900/30 dark:text-amber-100 dark:ring-amber-700/50',btn:'text-amber-700 hover:bg-amber-100/70 dark:text-amber-200 dark:hover:bg-amber-800/50'},
    info:{box:'bg-blue-50 text-blue-900 ring-1 ring-blue-200 dark:bg-blue-900/30 dark:text-blue-100 dark:ring-blue-700/50',btn:'text-blue-700 hover:bg-blue-100/70 dark:text-blue-200 dark:hover:bg-blue-800/50'},
    default:{box:'bg-blue-50 text-blue-900 ring-1 ring-blue-200 dark:bg-blue-900/30 dark:text-blue-100 dark:ring-blue-700/50',btn:'text-blue-700 hover:bg-blue-100/70 dark:text-blue-200 dark:hover:bg-blue-800/50'}
  };

  function showToast(message, category = 'info', {timeout = 4000} = {}) {
    const stack = document.getElementById('toast-stack');
    if (!stack) return;

    const styles = TOAST_STYLES[category] || TOAST_STYLES.default;
    const wrap = document.createElement('div');
    wrap.setAttribute('data-toast','');
    wrap.setAttribute('role', (category === 'error' || category === 'danger') ? 'alert' : 'status');
    wrap.className = `pointer-events-auto flex items-start gap-3 rounded-xl px-4 py-3 shadow-sm transition opacity-0 translate-y-2 ${styles.box}`;
    wrap.innerHTML = `
      <div class="min-w-0 text-sm font-medium">${message}</div>
      <button type="button" aria-label="Close"
              class="ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg transition ${styles.btn}">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
        </svg>
      </button>`;

    stack.appendChild(wrap);
    requestAnimationFrame(() => wrap.classList.remove('opacity-0','translate-y-2'));

    const remove = () => {
      wrap.classList.add('opacity-0','translate-y-2');
      setTimeout(() => wrap.remove(), 150);
    };
    wrap.querySelector('button')?.addEventListener('click', remove);
    if (timeout > 0) setTimeout(remove, timeout);
    return remove;
  }

  // Animate any server-flashed toasts that are already in the stack
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('#toast-stack [data-toast]').forEach(t => {
      requestAnimationFrame(() => t.classList.remove('opacity-0','translate-y-2'));
      const timeout = setTimeout(() => dismiss(t), 3000);
      t.querySelector('[data-toast-close]')?.addEventListener('click', () => {
        clearTimeout(timeout);
        dismiss(t);
      });
      function dismiss(el) {
        el.classList.add('opacity-0','translate-y-2');
        setTimeout(() => el.remove(), 250);
      }
    });
  });
</script>


        {% block content %}
          <script>
    window.addEventListener("beforeunload", function () {
      localStorage.setItem("scrollPosition", window.scrollY);
    });
    window.addEventListener("load", function () {
      const scrollPosition = localStorage.getItem("scrollPosition");
      if (scrollPosition !== null) {
        window.scrollTo(0, parseInt(scrollPosition, 10));
      }
    });
  </script>
        {% endblock %}

        

    </body>

</html>
